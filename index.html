<!--
 - [提单助手]
 - ©版权所有：2024-2025 YNYU @lvynyu2.gmail.com
 - 禁止未授权的商用及二次编辑
 - 禁止用于违法行为，如有，与作者无关
 - 二次编辑需将引用部分开源
 - 引用开源库的部分应遵循对应许可
-->
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>提单助手</title>
    <link rel="icon" href="https://mastergo.netease.com/mastergo-default/128405658053487/142634067922300/afd730bf13bf4bb25be55da2ed6d2735.png" type="image/png">

<style>
    :root {
        --mainColor: #acacac;
        --mainColor2: #378360;
        --mainColor3: #fff;
        --boxBod: #5d5d5d;
        --boxBak: #202020;
        --boxGry: #393939;
        --liColor1: #d03b3b;
        --link: #4e7075;
        --btn-copy-bg:#ffffff11;
        --bg-mask:20,20,20;   
        --hl-op:0.4;
        /*other*/
        --textarea-h:160px;
        --tips-copy:'复制';
        --keysLiColor:#983e3e;
        --bg-light:#81818154;
    }

    body {
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        gap:10px;
        padding: 0px 10px;
        font-family: Arial, Helvetica, sans-serif;
        font-size: 12px;
        font-weight: 700;
        color: var(--mainColor);
        position: relative;
        background-color: var(--boxBak);
        text-rendering: optimizeLegibility;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        letter-spacing: 0.01em;
        overflow: hidden;
        font-weight: 500;
    }
    html,body,.noselect {
        -webkit-user-select: none;/* Safari */
        -moz-user-select: none;/* Firefox */
        -ms-user-select: none;/* IE/Edge */
        user-select: none;/* 标准语法 */
    }

    .noscrollbar {
        scrollbar-width: none;
    }

    html::-webkit-scrollbar,
    body::-webkit-scrollbar,
    .noscrollbar::-webkit-scrollbar {
        display: none;
    }
    .noise{
        width: 100%;
        height: 100%;
        position: fixed;
        top: 0;
        left: 0;
        filter:url(#sharpness),grayscale();
        background: url("https://raw.githubusercontent.com/YNYU01/listEase/refs/heads/main/img/noise.png") 0 0/100px 100px,url("https://raw.githubusercontent.com/YNYU01/listEase/refs/heads/main/img/noise.png") 0 0/200px 200px;
        opacity: 0.07;
        z-index: 20;
        pointer-events: none;
    }

    optgroup {
        color:var(--mainColor3);
        text-align: left;
        font-size: var(--select-fsg,14px);
    }
    option {
        color:var(--mainColor);
        background-color: '';
        font-size: var(--select-fso,12px);
    }
    .ww{
        width: calc(100% - 80px);
        max-width: 1200px;
        min-width: 320px;
    }

    .page {
        min-height: 560px;
        height: calc(100% - 110px);
        display: flex;
        flex-flow: nowrap;
        gap:10px;
        justify-content: left;
        position: relative;
        background-color: var(--boxGry);
        border-radius: 20px;
        padding:20px ;
        font-weight: 700;
    }

    .page-box {
        width: 100%;
        height: 100%;
        display: flex;
        flex-flow: column;
        border-radius: 10px;
        box-shadow: 0 0 2px var(--bg-light),0 0 10px var(--bg-light);
        overflow: hidden;
    }

    .page-main {
        width: 100%;
        height: 100%;
        display: flex;
        flex-flow: column;
        justify-content: left;
        gap:10px;
        position: relative;
        overflow-y: scroll;
        border: var(--boxBod) 1px solid;
        border-radius: 0 0 10px 10px;
        box-sizing: border-box;
        padding:10px 10px 30px 10px;
        background-image: repeating-radial-gradient(
            circle at center,  
            rgba(0, 0, 0, 0.2) 0,
            rgba(0, 0, 0, 0.2) 1px,
            transparent 1px,
            transparent 20px
        );
        background-size:10px 10px ;
    }

    .model-box{
        width: 224px;
        height: 100%;
        display: flex;
        flex-flow: column;
        border-radius: 10px;
        overflow: hidden;
    }

    .model-list{
        display: flex;
        flex-flow: column;
        gap:10px;
    }

    .model-info{
        width: 200px;
        height: 130px;
        border-radius: 8px;
        border: var(--boxBod) 1px solid;
        animation: boxUp 0.5s;
        background: linear-gradient(to top,
        rgba(var(--bg-mask), 0.5) 0%,
        rgba(var(--bg-mask), 0.5) 25%,
        rgba(var(--bg-mask), 0.5) 75%,
        rgba(var(--bg-mask), 0.5) 100%),
        linear-gradient(296.5deg,
        rgba(0,0,0,0) 16.7%,
        var(--boxGry) 16.7%,
        var(--boxGry) 33.3%,
        rgba(0,0,0,0) 33.3%,
        rgba(0,0,0,0) 50%,
        var(--boxGry) 50%,
        var(--boxGry) 66.7%,
        rgba(0,0,0,0) 66.7%,
        rgba(0,0,0,0) 83.3%,
        var(--boxGry) 83.3%
        ) 0 0/100px 100px,var(--boxBak) 
        ;
        /*
        background-size: 100px 100px;
        background-repeat: repeat;
        */
        animation: skewliner linear 5s infinite;
    }

    .model-pick{
        --model-img: '';
        border-radius: 8px; 
        overflow: hidden;
        --model-info:0;
    }
    .model-pick:hover{
        --model-info:1;
    }

    input[type="checkbox"]:checked+.model-pick {
        --model-b: var(--mainColor) 1px solid;
        --model-info:1;
    }

    .model-move-r,.model-move-l{
        display: none;
    }

    .btn-text {
        cursor: pointer;
        color: var(--mainColor);
        z-index: 2;
    }

    .btn-text:hover {
        opacity: 0.5;
    }

    .tags-exports {
        border-radius: 8px;
        width: calc(100% - 20px);
        display: flex;
        flex-flow: column;
        gap:10px;
        padding: 6px 8px 8px 10px ;
        background: var(--boxBak);
        font-size: 10px;
        animation: boxUp 0.5s;
        border: var(--boxBod) 1px solid;
        box-shadow: 0 0 10px  rgba(0, 0, 0, 0.2) inset,0 0 1px  #6e6e6e, 0 2px 0 var(--boxBak);
    }

    .tags-exports .list {
        width: 100%;
        opacity: 0.8;
        display: flex;
        flex-flow: column;
        gap:10px;
        justify-content: left;
    }
    .tags-exports .set {
        width: 100%;
        display: flex;
        justify-content: left;
        gap: 10px;
        opacity: 0.8;
        gap:4px;
    }
    .tags-exports .group {
        width: 100%;
        display: flex;
        justify-content: left;
        flex-flow: column;
        gap: 10px;
        opacity: 0.8;
        gap:4px;
    }
  
    .input-btn-skill {
        width: 100%;
        height: 20px;
        display: flex;
        justify-content: center;
        align-items: center;
        text-align: center;
        background-color: var(--boxBak);
        border-radius: 4px;
        border: var(--boxBod) 1px solid;
        color: var(--mainColor);
        outline: none;
    }

    .textarea-in-out{
        display: flex;
        width: 100%;
        gap:4px;
        flex-flow: column;
        max-width: 680px;
    }

    .textarea-box{
        width: 100%;
        max-width: 100%;
        position: relative;
    }
    .textarea-box::before{
        content: var(--title,'· 标题');
        width: var(--title-w,100%);
        height: 24px;
        position: absolute;
        display: flex;
        align-items: center;
        border-radius: var(--top-r,8px 8px 0 0);
        border-bottom-left-radius: 0;
        padding-left: 10px;
        border: var(--boxBod) 1px solid;
        top: 0;
        left: 0;
        background-color: var(--boxBak);
        z-index: 2;
        box-sizing: border-box;
    }
    .input-textarea {
        border-radius: 8px;
        padding: 26px 4px 4px 10px;
        background-color: var(--boxBak);
        color: var(--mainColor);
        outline: none;
        opacity: 0.7;
        resize: vertical;
        font-size: 10px;
        box-shadow: 0 0 10px  #00000077 inset;
        position: relative;
    }
    

    .input-textarea:focus {
        opacity: 1;
    }


    .export-tips{
        font-size: 10px;
        display: flex;
        flex-flow: column;
        gap:4px;
        justify-content: space-between;
        border: var(--boxBod) 1px solid;
        border-radius:10px 10px  0 0 ;
        box-sizing: border-box;
        padding: 10px;
        margin-bottom: -1px;
        background-color: var(--boxBak);
        position: relative;
    }

    .btn-copy{
        color:var(--mainColor);
        width: 30px;
        height: 16px;
        border-radius: 5px;
        position: absolute;
        right:10px;
        top:4px;
        animation: boxUp 1s;
        border: 1px #ffffff00 solid;
    }
    .btn-copy::after{
        content: var(--tips-copy);
        width: 100%;
        height: 16px;
        font-size: 10px;
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: var(--btn-copy-bg);
        border-radius: 4px;
        position: absolute;
        box-sizing: border-box;
    }
    .btn-copy:hover{
        border: 1px var(--boxBod) solid;
    }
    .re-tips-area{
        border-radius: 8px;
        padding: 4px 4px 4px 10px;
        font-size: 10px;
        /*--bg-mask:20,20,20; */
        background:
        linear-gradient(to top,
        rgba(var(--bg-mask), 0.5) 0%,
        rgba(var(--bg-mask), 0.5) 25%,
        rgba(var(--bg-mask), 0.5) 75%,
        rgba(var(--bg-mask), 0.5) 100%),
        linear-gradient(296.5deg,
        rgba(0,0,0,0) 16.7%,
        var(--boxGry) 16.7%,
        var(--boxGry) 33.3%,
        rgba(0,0,0,0) 33.3%,
        rgba(0,0,0,0) 50%,
        var(--boxGry) 50%,
        var(--boxGry) 66.7%,
        rgba(0,0,0,0) 66.7%,
        rgba(0,0,0,0) 83.3%,
        var(--boxGry) 83.3%
        ),var(--boxBak);
        background-size: 100px 100px;
        background-repeat: repeat;
        color: var(--mainColor);
        box-sizing: border-box;
        border: 1px var(--boxBod) solid;
        box-shadow: 0 0 10px  #00000077 inset;
        animation: skewliner linear 5s infinite;
    }
    .AIloadding{
        position: absolute;
        --wh:20px;
        width: var(--wh);
        height: var(--wh);
        top: calc(50% - var(--wh)/2);
        left: calc(50% - var(--wh)/2);
        background-color: var(--boxBak);
        z-index: 3;
        border-radius: 50%;
        border: var(--boxBod) 1px solid;
        box-sizing: border-box;
        padding: 2px;
        transform: scale(1) rotateX(180deg);
        box-shadow: 0 0 4px 1px rgba(0, 0, 0, 0.2);
    }
    .AIloadding:hover{
        --wh:24px;
        cursor: pointer;
        /*animation: loading 1s linear infinite;*/
    }
    @keyframes loading {
        from{
            transform:scale(1) rotateX(180deg) rotate(0deg);
        }to{
            transform:scale(1) rotateX(180deg) rotate(-360deg);
        }
    }
    .btn-main{
        background:
        repeating-radial-gradient(
            circle at center,  
            rgba(62, 62, 62, 0.2) 0,
            rgba(62, 62, 62, 0.2) 1px,
            rgba(119, 119, 119, 0.2) 1px,
            rgba(119, 119, 119, 0.2) 1.5px,
            transparent 4px,
            transparent 20px
        ),var(--boxBak);
        background-size:5px 5px;
        border: 0.5px var(--boxBod) solid;
        border-radius: 20px;
        box-shadow: 0 0 10px  rgba(0, 0, 0, 0.2) inset,0 0 1px  #6e6e6e, 0 2px 0 var(--boxBak);
        padding: 4px;
    }
    .btn-mini{
        width: 18px;
        height: 18px;      
        justify-content: center;
        align-items: center;
        font-size: 8px;
        background:var(--boxBak);
        background-size:5px 5px;
        border-radius: 20px;
        padding: 4px;
        border: 0.5px var(--boxBod) solid;
        box-sizing: border-box;
    }
    .btn-mini:hover{
        font-size: 10px;
        width: 22px;
        height: 22px;
        cursor: pointer;
        --move:-2px
    }

    .btn-theme {
        --theme-l:rgba(0,0,0,0);
        --theme-d:var(--mainColor);
    }

    .btn-theme:hover {
        cursor: pointer;
        opacity: 0.8;
    }

    input[type="checkbox"]:checked+.btn-theme {
        --theme-l:var(--mainColor);
        --theme-d:rgba(0,0,0,0);
    }

    .btn-editor{
        position: relative;
        border-radius: 50%;
        border: rgba(0, 0, 0, 0) 2px solid;
        --btn-op: 0.2;
    }
    input[type="checkbox"]:checked+.btn-editor {
        --btn-op: 1;
    }

    .tool-top{
        width: calc(100% + 40px);
        --tool-title-w:180px;
        margin-left: -15px;
        border: 0.5px var(--boxBod) solid;
        background:/*linear-gradient(to top, rgba(0,0,0,0) 0%, rgba(var(--bg-mask), 1) 40%,rgba(0,0,0,0) 100%),*/var(--bg-light);
        border-radius: 12px;
        /*box-shadow: 0 4px 10px  rgba(var(--bg-mask), 1) inset,0 0 1px  #6e6e6e, 0 2px 0 var(--boxBak);*/
    }
    .tool-title{
        width: var(--tool-title-w,100%);
        color: var(--mainColor);
        font-weight: 700;
        position: relative;
        display: flex;
        align-items: center;
        gap: 4px;
        background:
        /*repeating-radial-gradient(
            circle at center,  
            rgba(62, 62, 62, 0.2) 0,
            rgba(62, 62, 62, 0.2) 1px,
            rgba(119, 119, 119, 0.2) 1px,
            rgba(119, 119, 119, 0.2) 1.5px,
            transparent 4px,
            transparent 20px
        ),*/var(--boxBak);
        background-size:5px 5px;
        padding: 2px 8px 3px 20px;
        box-sizing: border-box;
        border: 0.5px var(--boxBod) solid;
        border-radius: 10px;
        box-shadow: 0 0 6px rgba(0, 0, 0, 0.5) inset,0 0 1px  #6e6e6e/*, 0 2px 0 var(--boxBak)*/;
    }
    .tool-title::before{
        content: '';
        position: absolute;
        top:5.5px;
        left: 5px;
        width: 8px;
        height: 8px;
        border-radius: 50%;
        border: 0.5px var(--boxBod) solid;
        z-index: 2;
        animation: lightup ease-in-out 1s infinite;
    }
    .tool-title::after{
        content: '';
        position: absolute;
        top:5.5px;
        left: 5px;
        width: 8px;
        height: 8px;
        filter: blur(5px);
        border-radius: 50%;
        border: 0.5px var(--boxBod) solid;
        z-index: 2;
        animation: lightup ease-in-out 1s infinite;
    }
    @keyframes lightup {
        0%{
            background: repeating-radial-gradient(
                circle at center,  
                rgba(125, 248, 252, 0) 0,
                rgba(125, 247, 252, 0) 4px,
                rgba(119, 119, 119, 0) 8px
            ),var(--boxBak);
        }
        50%{
            background: repeating-radial-gradient(
                circle at center,  
                rgba(125, 248, 252, 0.705) 0,
                rgba(125, 247, 252, 0.6) 4px,
                rgba(119, 119, 119, 0.2) 8px
            ),var(--boxBak);
        }
        100%{
            background: repeating-radial-gradient(
                circle at center,  
                rgba(125, 248, 252, 0) 0,
                rgba(125, 247, 252, 0) 4px,
                rgba(119, 119, 119, 0) 8px
            ),var(--boxBak);
        }
    }
    .tool-option{
        width: 100%;
        text-align: center;
        background-color: var(--hover,rgba(0,0,0,0));
        padding:4px 10px;
    }

    .tool-option:hover {
        cursor: pointer;
        --hover:var(--boxGry)
    }

    .tool-option-pick{
        width: 100%;
        text-align: center;
        background-color: rgba(70,220,210,0.2);
        padding:4px 10px;
        pointer-events: none;
    }

    .tool-list {
        position: absolute;
        top:10px;
        width: var(--tool-title-w,100%);
        display: flex;
        flex-flow: column;
        padding:20px 10px 8px 10px;
        box-sizing: border-box;
        background-color: var(--boxBak);
        border: var(--boxBod) 1px solid;
        border-radius:0 0 10px 10px;
    }

    .tips-all{
        position: absolute;
        bottom: 80px;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 2px 8px;
        z-index: 20;
        animation: boxUp 0.3s ease-out;
    }
    .tips-all .tips-box{
        font-size: 14px;
        display: flex;
        align-items: center;
        padding: 4px 20px;
        color: #fff;
        background-color: rgba(0, 0, 0, 0.8);
        border-radius: 15px;
        opacity: 0.8;
    }

    .tags-search-toast {
        width: var(--toastW, 100px);
        text-align: center;
        position: absolute;
        bottom: 10px;
        padding: 2px 4px;
        border-radius: 4px;
        color: #ffffff;
        background-color: #000000;
        pointer-events: none;
    }

    .tags-search-toast-area {
        position: absolute;
        width: 18px;
        height: 18px;
        bottom: 1px;
        right: -1px;
        opacity: 00;
        z-index: 2;
        cursor: pointer;
    }

    .tags-search-toast-area:hover {
        opacity: 1;
        transition: opacity 0.2s ease-out,background-color 0.5s ease-out;
    }

    .tags-search-toast-area:hover .tags-search-toast {
        transform: translateY(-10px);
        transition: transform 0.2s ease-out,background-color 0.5s ease-out;
    }

    #textarea-in{
        --r:8px;
        --top-r:var(--r) var(--r) 0 0;
        --bottom-r:0 0 var(--r) var(--r);
    }

    @keyframes skewliner {
        0%{
            background-position: 0 0;
        }
        100%{
            background-position: 100px 0;
        }
    }

    @keyframes boxUp{
        0%{
            transform: translateY(10px);
            opacity: 0;
        }
        100%{
            transform: translateY(0);
            opacity: 1
        }

    }

    @keyframes listclose {
        0%{
            transform: translateY(0);
        }
        100%{
            transform: translateY(-30px);
        }
    }

    @media (max-width:750px){
        :root{
            --textarea-h:100px;
        }
        .page{
            display: flex;
            flex-flow: column;
        }
        .tags-exports .list {
            display: flex;
            flex-flow: column;
            gap:10px;
            justify-content: left;
        } 
        #export-info{
            --mh:100px
        }
        #textarea-in{
            display: flex;
            --title-w:50%;
            --top-r:var(--r) 0 0 var(--r);
            --bottom-r:0 var(--r) var(--r) 0;
        }
        #btn-totags{
            /*left: calc(50% - 10ch - 4px);*/
            --top:0px;
        }
        #select-area-ai{
            left: calc(50% - 14ch - 3px);
            transition: right ease-in-out 0.5s;
        }
        #model-main{
            padding: 10px;
            overflow-x: scroll;
        }
        .model-box{
            width: 100%;
            height: 200px;
        }
        .model-list{
            width: fit-content;
            flex-flow:nowrap;
            
        }
        .model-info{
            width: 150px;
            height: 98px;
        }
        .model-move-r,.model-move-l{
            display: flex;
        }
        
    }

    @media (min-width:1100px){
        .tags-exports .list {
            display: flex;
            flex-flow: nowrap;
            justify-content: space-between;
        }
        .export-tips{
            flex-flow: nowrap;
        }
        
    }


</style>

<body class="noselect">
    <div id="noise" class="noise"></div>
    <!--全局tips-->
    <div id="tips-all" class="ww tips-all" style="display: none;">
        <div id="tips-box" class="tips-box" >
            温馨提示
        </div>
    </div>
    <!--顶栏-->
    <div class="ww" style=" display: flex; justify-content: space-between; align-items: center; position: relative;z-index: 10;">
        
        <div class="tool-top" >
            <div id="tool-list" class="tool-list" style=" align-items: center; display: none;">
                <div id="tool-list-1" class="tool-option-pick" onclick="viewPage(1)">资源位标准格式转换器</div>
                <div id="tool-list-2" class="tool-option" onclick="viewPage(2)">模板解析及批量延展器</div>
                <div id="tool-list-3" class="tool-option" onclick="viewPage(3)">布局示意图批量生成器</div>
            </div>
            <div class="tool-title">
                <div id="tool-name" style="width:100%; "></div>
                <div  id="tool-change" class="btn-text" style="width: 18px; height: 12px; margin-top: 2px; background-color: var(--boxBak); border: var(--boxGry) 1px solid; border-radius: 6px;"  
                onclick="document.getElementById('tool-list').style.display = 'flex';">
                <btn-change></btn-change>
                </div>
            </div>
            
        </div>
        <div class="btn-main" style="width: 14px; height: 14px; flex:0 0 auto; margin-top: -2px;margin-right: -15px;">
            <input id="theme" type="checkbox" checked="true" style="display: none;" onchange="
            if(!this.checked){
            console.log('浅色主题')
            for (var i = 0; i < styleKey.length; i++) {
                root.style.setProperty('--' + styleKey[i], styleValue[i])
            }
            } else {
            console.log('深色主题')
            for (var i = 0; i < styleKey2.length; i++) {
                root.style.setProperty('--' + styleKey2[i], styleValue2[i])
            }
            }
        "></input>
            <label for="theme" class="btn-theme" style="position: relative;">
            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" version="1.1" width="100%" height="100%" viewBox="0 0 12 12">
                <g>
                <g>
                    <rect x="5" y="9" width="1.5" height="3" rx="0" fill="var(--theme-l)" fill-opacity="1" />
                </g>
                <g transform="matrix(0.7071067690849304,0.7071067690849304,-0.7071067690849304,0.7071067690849304,6.1715640705951955,-0.07104350035297102)">
                    <rect x="3.171539306640625" y="7.414215087890625" width="1.5" height="3" rx="0" fill="var(--theme-l)" fill-opacity="1" />
                </g>
                <g>
                    <rect x="5.25" y="0" width="1.5" height="3" rx="0" fill="var(--theme-l)" fill-opacity="1" />
                </g>
                <g>
                    <ellipse cx="6" cy="6" rx="2" ry="2" fill="var(--theme-l)" fill-opacity="1" />
                </g>
                <g transform="matrix(0.7071067690849304,0.7071067690849304,-0.7071067690849304,0.7071067690849304,3.5355376705865638,-6.435017716257789)">
                    <rect x="9.5355224609375" y="1.050262451171875" width="1.5" height="3" rx="0" fill="var(--theme-l)" fill-opacity="1" />
                </g>
                <g transform="matrix(5.400848479553133e-8,1,-1,5.400848479553133e-8,16.999999351898182,-7.000000270042424)">
                    <rect x="12" y="5" width="1.5" height="3" rx="0" fill="var(--theme-l)" fill-opacity="1" />
                </g>
                <g transform="matrix(-0.7071067690849304,0.7071067690849304,-0.7071067690849304,-0.7071067690849304,25.434929892247965,8.535490881769874)">
                    <rect x="10.94970703125" y="9.535491943359375" width="1.5" height="3" rx="0" fill="var(--theme-l)" fill-opacity="1" />
                </g>
                <g transform="matrix(5.400848479553133e-8,1,-1,5.400848479553133e-8,7.999999837974546,1.999999729957576)">
                    <rect x="3" y="5" width="1.5" height="3" rx="0" fill="var(--theme-l)" fill-opacity="1" />
                </g>
                <g transform="matrix(-0.7071067690849304,0.7071067690849304,-0.7071067690849304,-0.7071067690849304,10.070989280409776,2.1715382450511242)">
                    <rect x="4.58575439453125" y="3.171539306640625" width="1.5" height="3" rx="0" fill="var(--theme-l)" fill-opacity="1" />
                </g>
                </g>
            </svg>
            <svg style="position: absolute; top: -2px; left: 0;" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" version="1.1" width="100%" height="100%" viewBox="0 0 12 12">
                <g>
                <path d="M1.38229,8.82346Q1.51731,8.82346,1.65217,8.81683Q1.78702,8.81021,1.92139,8.79697Q2.05576,8.78374,2.18931,8.76393Q2.32287,8.74411,2.45529,8.71777Q2.58771,8.69143,2.71868,8.65863Q2.84966,8.62582,2.97886,8.58663Q3.10806,8.54743,3.23519,8.50195Q3.36231,8.45646,3.48705,8.40479Q3.61179,8.35312,3.73385,8.2954Q3.8559,8.23767,3.97498,8.17402Q4.09405,8.11038,4.20986,8.04096Q4.32567,7.97155,4.43793,7.89654Q4.55019,7.82153,4.65864,7.7411Q4.76709,7.66067,4.87146,7.57501Q4.97583,7.48936,5.07587,7.39869Q5.17591,7.30801,5.27138,7.21254Q5.36685,7.11707,5.45752,7.01703Q5.5482,6.91699,5.63385,6.81262Q5.7195,6.70825,5.79993,6.5998Q5.88036,6.49135,5.95538,6.37909Q6.03039,6.26683,6.0998,6.15102Q6.16921,6.03521,6.23286,5.91614Q6.29651,5.79706,6.35423,5.67501Q6.41196,5.55295,6.46363,5.42821Q6.5153,5.30347,6.56079,5.17635Q6.60627,5.04922,6.64547,4.92002Q6.68466,4.79082,6.71747,4.65985Q6.75027,4.52888,6.77661,4.39645Q6.80295,4.26403,6.82276,4.13047Q6.84258,3.99692,6.85581,3.86255Q6.86904,3.72818,6.87567,3.59333Q6.88229,3.45847,6.88229,3.32346Q6.88229,2.87639,6.81009,2.4352Q6.73789,1.99401,6.59539,1.57027Q6.45288,1.14653,6.24381,0.751369Q6.03474,0.356206,5.7646,-0.00000434251Q5.98378,0.0569073,6.19753,0.131643Q6.41128,0.206379,6.61817,0.298434Q6.82506,0.390488,7.02368,0.499238Q7.2223,0.607988,7.41131,0.732697Q7.60032,0.857406,7.77844,0.99723Q7.95655,1.13705,8.12257,1.29105Q8.28859,1.44504,8.44139,1.61216Q8.59419,1.77928,8.73274,1.95839Q8.87128,2.13751,8.99463,2.3274Q9.11798,2.5173,9.22531,2.71669Q9.33263,2.91609,9.4232,3.12363Q9.51377,3.33117,9.58698,3.54546Q9.66018,3.75974,9.71552,3.97932Q9.77086,4.19889,9.80796,4.42228Q9.84507,4.64566,9.86368,4.87134Q9.88229,5.09701,9.88229,5.32346Q9.88229,5.45847,9.87567,5.59333Q9.86904,5.72818,9.85581,5.86255Q9.84258,5.99692,9.82276,6.13047Q9.80295,6.26403,9.77661,6.39645Q9.75027,6.52888,9.71747,6.65985Q9.68466,6.79082,9.64546,6.92002Q9.60627,7.04922,9.56079,7.17635Q9.5153,7.30347,9.46363,7.42821Q9.41196,7.55295,9.35423,7.67501Q9.29651,7.79706,9.23286,7.91614Q9.16921,8.03521,9.0998,8.15102Q9.03039,8.26683,8.95538,8.37909Q8.88036,8.49135,8.79993,8.5998Q8.7195,8.70825,8.63385,8.81262Q8.5482,8.91699,8.45752,9.01703Q8.36685,9.11707,8.27138,9.21254Q8.17591,9.30801,8.07587,9.39869Q7.97583,9.48936,7.87146,9.57501Q7.76709,9.66067,7.65864,9.7411Q7.55019,9.82153,7.43793,9.89654Q7.32567,9.97155,7.20986,10.041Q7.09405,10.1104,6.97498,10.174Q6.8559,10.2377,6.73385,10.2954Q6.61179,10.3531,6.48705,10.4048Q6.36231,10.4565,6.23519,10.5019Q6.10806,10.5474,5.97886,10.5866Q5.84966,10.6258,5.71868,10.6586Q5.58771,10.6914,5.45529,10.7178Q5.32287,10.7441,5.18931,10.7639Q5.05576,10.7837,4.92139,10.797Q4.78702,10.8102,4.65217,10.8168Q4.51731,10.8235,4.38229,10.8235Q4.06502,10.8235,3.74985,10.787Q3.43469,10.7505,3.1258,10.678Q2.81692,10.6055,2.51842,10.498Q2.21992,10.3905,1.93577,10.2494Q1.65161,10.1082,1.38557,9.93536Q1.11953,9.76249,0.87513,9.56018Q0.630731,9.35786,0.411216,9.12879Q0.191702,8.89971,-0.0000144195,8.64691Q0.679868,8.82346,1.38229,8.82346Z" 
                fill-rule="evenodd" fill="var(--theme-d)" fill-opacity="1"/>
                </g>
            </svg>
            </label>
        </div>
        
    </div>
    <!--加载-->
    <div class="ww page"  id="page-0" style="display: flex;"></div>
    <!--页面1-->
    <div class="ww page"  id="page-1" style="display: none;">
        <div class="textarea-in-out" style="position: relative;" >
            <div class="textarea-box" id="textarea-in" style="--title:'· [ 输入 ]';">
                
                <div id="btn-ai" class="AIloadding" onclick="this.style.animation = 'loading 1s linear infinite';AItoKeys(document.getElementById('import-info').value)"><btn-re></btn-re></div>
                <textarea id="import-info" placeholder="选择要匹配的渠道，输入带关键信息的文本，点击转换进行规范匹配，确认无误后可生成标签" class="input-textarea noscrollbar" style="resize: none; border-radius: var(--top-r); width: 100%; height: var(--textarea-h);"></textarea>
                <div id="import-re" class="re-tips-area noscrollbar" style="border-radius: var(--bottom-r);width: 100%; height: var(--textarea-h);">【敬请期待~】</div>
                
                <div class="btn-copy" id="btn-totags" style="width: 10ch; right:4px;top: calc(var(--top,50%) + 4px); z-index: 2; animation:none; --tips-copy:'# 生成标签';" onclick="
                    this.style.setProperty('--tips-copy','&quot~\(≧▽≦)/~&quot');
                    this.style.setProperty('--btn-copy-bg','#bb77ff77');
                    setTimeout(() => { this.style.setProperty('--tips-copy','&quot;# 生成标签&quot;');
                    this.style.setProperty('--btn-copy-bg','#ffffff11');},1000);
                    ">
                </div>
                <select id="select-area-ai" class="input-btn-skill" name="渠道" style="z-index: 2; --select-fso:10px ; height: 18px; width: 14ch; min-width: 14ch; color: var(--mainColor); font-size: 10px; position: absolute; top: 3px; right: 3px;" 
                onchange="AItoKeysArea = this.value">
                </select>
            </div>
            <div class="textarea-box" id="textarea-out" style="--title:'· [ 输出 ]'; height: 100%;">
                <div class="btn-copy" id="btn-copy" style="z-index: 2; display: none;" onclick="
                this.style.setProperty('--tips-copy','&quot✔&quot');
                this.style.setProperty('--btn-copy-bg','#77ff7777');
                setTimeout(() => { this.style.setProperty('--tips-copy','&quot;复制&quot;');
                this.style.setProperty('--btn-copy-bg','#ffffff11');},1000);
                navigator.clipboard.writeText(document.getElementById('export-info').value.trim()) .then(function() { console.log('复制成功'); alert('复制成功，可直接粘贴到表格，或模板生成插件')});">
                </div>
                <textarea id="export-info" placeholder="选择渠道和资源位后，将在此处输出标准格式，可用于规范提单和模板生成"  
                class="input-textarea noscrollbar" 
                style="width: 100%; height: 100%;min-height: var(--mh,200px);max-height: calc(50vh - 15px); resize: none;"></textarea>
            </div>
        </div>
        <div class="page-box" >
            <div class="export-tips">
                <div style="font-size: 12px;">· [ 标签 ]</div>
                <div style="height: 18px; display: flex; justify-content: space-between; gap:4px; align-items: center;">
                    <span>
                        切图:
                        <span id="num-img">--</span>;&nbsp;
                        效果图:
                        <span id="num-view">--</span>;&nbsp;
                        合计:
                        <span id="num-all" style="color: var(--mainColor3);">--</span>;&nbsp;
                        预估人天:
                        <span id="num-d" style="color: var(--mainColor2);">--</span>;
                    </span>
                    <div class="btn-copy" id="btn-copy-info" style="width: 10ch; position: relative; top:0; right: 0; z-index: 2; display: none; animation:none; --tips-copy:'复制详情';" onclick="
                        this.style.setProperty('--tips-copy','&quot✔&quot');
                        this.style.setProperty('--btn-copy-bg','#77ff7777');
                        setTimeout(() => { this.style.setProperty('--tips-copy','&quot复制详情&quot');
                        this.style.setProperty('--btn-copy-bg','#ffffff11');},1000);
                        navigator.clipboard.writeText(exportAllInfo) .then(function() { console.log('复制成功'); alert('复制详情成功，可用于需求信息汇总')});">
                    </div>
                </div>
                
            </div>
            <div style="height: 18px;display: flex; align-items: center; opacity: 0.5; transform: skewX(-8deg); position: absolute; bottom: 34px; right: 40px; font-size:10px;">*选择渠道后显示对应资源位选项,切换渠道将清空资源位选项</div>
            <!--此容器内自动添加子容器-->
            <div class="page-main noscrollbar" id="page-main-1" >
                <div class="tags-exports" id="exports-0">
                    <div class="list">
                        <div class="set" style="width: 60ch;">
                            <div style="display: flex; gap:4px">
                                <div id="add-0" class="btn-text" style="width: 17px; height: 17px;" onclick="addList(1);this.parentNode.style.opacity = 0.222; this.parentNode.style.pointerEvents = 'none';"><btn-add></btn-add></div>
                                <div id="close-0" class="btn-text" style="width: 17px; height: 17px; opacity:0.222; pointer-events: none;" ><btn-close></btn-close></div>
                            </div>
                            <select id="select-area-0" class="input-btn-skill" name="渠道" style=" width: 26ch; min-width: 20ch; color: var(--mainColor); font-size: 12px;" 
                            onchange="reSelectImg(0,this.value);reImgInfo(0,0,null);reKeysInfo(0,this.value);document.getElementById('imgs-0').style.display = 'flex'">
                            </select>
                        </div>
                        <div class="group" id="imgs-0" style="display: none; max-width: 500px;">
                            <div class="set" id="img-0-0" >
                                <div style="display: flex; gap:4px">
                                    <div id="add-0-0" class="btn-text" style="width: 17px; height: 17px;" onclick="addImg(0,1,allKey[0]);this.parentNode.style.opacity = 0.222; this.parentNode.style.pointerEvents = 'none';reImgInfo(0,0,document.getElementById('select-img-0-1').value)"><btn-add></btn-add></div>
                                    <div id="close-0-0" class="btn-text" style="width: 17px; height: 17px; opacity:0.222; pointer-events: none;" ><btn-close></btn-close></div>
                                </div>
                                <select id="select-img-0" class="input-btn-skill" name="资源位" style=" width: calc(100% - 8ch); color: var(--mainColor); font-size: 12px; text-align: left;" 
                                onchange="reImgInfo(0,0,this.value)">
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--页面2-->
    <div class="ww page"  id="page-2" style="display: none;">
        <div class="model-box" style="position: relative;overflow:visible">
            <div class="export-tips">
                <div style="font-size: 12px;">· [ 模板 ]</div>               
            </div>
            <!--此容器内自动添加子容器-->
            <div class="page-main noscrollbar" id="model-main" style="background: var(--boxBak);" >
                <div class="model-list" id="model-list" style="transition: transform 0.5s ease-in-out;">
                    <div class="model-info" style="background: var(--boxBak);">
                        <input type="file" id="model-pick-user" style="display: none;" />
                        <label class="model-pick"  for="model-pick-user" style="position: relative;">
                            <div style="position: absolute; bottom:-1px; background:rgba(0,0,0,0.2); width:100%; height:30px; display:flex; justify-content: center;align-items: center; border-radius:0 0 8px 8px; opacity:var(--model-info) ; ">本地模板</div>
                            <div class="btn-text" style="width: 50%; height: 50%; position: absolute; top: 25%; left: 25%;"><btn-add style="opacity: 0.6;"></btn-add></div>
                            <div style="width:100%; height:100%; box-sizing: border-box; background:var(--model-img); border-radius: 8px; border:var(--model-b); padding:4px " ></div>
                        </label>
                    </div>
                </div>      
            </div>
            <div class="model-move-r btn-mini" style="position: absolute; top:calc(50% + 8px + var(--move,0px));transform: translateX(-50%);"
            onclick="var moveNum = Math.floor(this.parentNode.offsetWidth/162) * 162; modelMain.scrollTo({left:modelMain.scrollLeft - moveNum,behavior:'smooth'});"
            >◀&nbsp;</div>
            <div class="model-move-l btn-mini" style="position: absolute; top:calc(50% + 8px + var(--move,0px)); right: 0; transform: translateX(50%);"
            onclick="var moveNum = Math.floor(this.parentNode.offsetWidth/162) * 162; modelMain.scrollTo({left:modelMain.scrollLeft + moveNum,behavior:'smooth'});"
            >&nbsp;▶</div>
        </div>
        <div class="page-box" style="overflow:visible">
            <div class="export-tips" >
                <div style="font-size: 12px; min-width: fit-content;">· [ 编辑 ]</div>    
                <div style="width: 100%; display: flex; justify-content: space-between; ">
                    <div style=" opacity: 0.8;margin-top: 2px;">*切换模式以编辑模板</div>
                    <div id="styleLinkAndNew" style="display: flex; gap: 8px; align-items: center;">
                        <input type="checkbox" style="display: none;" id="editor-data" onchange="this.checked = true;if(this.checked == true){ediF.checked = false;ediV.checked = false}">
                        <label class="btn-editor" for="editor-data">
                            <div style="box-shadow:0 0 6px 2px #3fffa555 inset,0 0 10px  #65fdc8b4; opacity: var(--btn-op); background-color:#00ba798e;  width: 18px; height: 18px; box-sizing: border-box; border: rgba(255, 255, 255,var(--hl-op)) 1px solid; border-radius: 9px; position: relative" >
                            </div>
                            <div class="tags-search-toast-area" style="right: 0; bottom: -1px;width: 18px; ">
                                <div class="tags-search-toast" style="width: 60px; right: -30px;z-index: 30;"> 参数模式</div>
                            </div>
                        </label>

                        <input type="checkbox" style="display: none;" checked="true" id="editor-flow" onchange="this.checked = true;if(this.checked == true){ediD.checked = false;ediV.checked = false}">
                        <label class="btn-editor" for="editor-flow" >
                            <div style="box-shadow:0 0 6px 2px #fff23f69 inset,0 0 10px  #fdd465b4; opacity: var(--btn-op); background-color:#f1902ead;  width: 18px; height: 18px; box-sizing: border-box; border: rgba(255, 255, 255,var(--hl-op)) 1px solid; border-radius: 9px; position: relative">
                            </div>
                            <div class="tags-search-toast-area" style="right: 0; bottom: -1px;width: 18px; ">
                                <div class="tags-search-toast" style="width: 60px; right: -30px;z-index: 30;"> 节点模式</div>
                            </div>
                        </label>

                        <input type="checkbox" style="display: none;" id="editor-view" onchange="this.checked = true;if(this.checked == true){ediF.checked = false;ediD.checked = false}">
                        <label class="btn-editor" for="editor-view">
                            <div style="box-shadow:0 0 6px 2px #848aea69 inset,0 0 10px  #6579fdb4; opacity: var(--btn-op); background-color:#5c6672b9;  width: 18px; height: 18px; box-sizing: border-box; border: rgba(255, 255, 255,var(--hl-op)) 1px solid; border-radius: 9px; position: relative;">
                            </div>
                            <div class="tags-search-toast-area" style="right: 0; bottom: -1px;width: 18px; ">
                                <div class="tags-search-toast" style="width: 60px; right: -20px;z-index: 30;"> 预览模式</div>
                            </div>
                        </label>
                    </div>
                  </div>           
            </div>
            <!--此容器内自动添加子容器-->
            <div class="page-main noscrollbar" id="page-main-2" >

            </div>
        </div>
    </div>
    <!--页面3-->
    <div class="ww page"  id="page-3" style="display: none;"></div>
    <!--底栏-->
    <div class="ww" style="opacity: 0.5; bottom: 8px; left:24px; font-size: 10px;display: flex; justify-content: space-between;">
        <div>提单助手 v0.1.0</div>
        <div>©YNYU @lvynyu2.gmail.com</div>
    </div>
    <svg style="display: none;">
        <filter id="sharpness">
            <feConvolveMatrix in="SourceGraphic"  order="3" kernelMatrix="0 -1 0 -1 2 -1 0 -1 0"/>
        </filter>
    </svg>
<script src="https://cdn.jsdelivr.net/npm/compromise@latest/builds/compromise.min.js">//英文AI</script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js/dist/fuse.js">//模糊匹配</script>
<script>
    //纯数字的键名要带下划线，避免被识别成数字序号
    const vivo = [
    {name:"游戏中心-悬浮窗",w:280,h:280,s:"200k",type:"png",d:0.01,view:false},
{name:"游戏中心-精选页banner1",w:1080,h:380,s:"150k",type:"jpg",d:0.07,view:false},
{name:"游戏中心-精选页banner1-破窗款",w:1080,h:380,s:"150k",type:"png",d:0.07,view:false},
{name:"游戏中心-精选页banner2",w:1080,h:580,s:"150k",type:"jpg",d:0.07,view:false},
{name:"游戏中心-闪屏-全屏",w:1080,h:2160,s:"300k",type:"jpg",d:0.1,view:false},
{name:"游戏中心-闪屏-半屏",w:1080,h:1880,s:"300k",type:"jpg",d:0.1,view:false},
{name:"游戏中心-闪屏-游戏专用",w:1080,h:1920,s:"300k",type:"jpg",d:0.1,view:false},
{name:"四号位卡片",w:480,h:789,s:"150k",type:"jpg",d:0.05,view:false},
{name:"游戏中心-胶囊banner",w:1080,h:240,s:"",type:"png",d:0.05,view:false},
{name:"游戏中心-插屏模板-主图",w:810,h:810,s:"300k",type:"png",d:0.07,view:false},
{name:"游戏中心-插屏模板-按钮",w:272,h:94,s:"300k",type:"png",d:0.01,view:false},
{name:"游戏中心-金刚位",w:165,h:165,s:"",type:"png",d:0.05,view:false},
{name:"游戏中心-底部bar-未选中",w:96,h:96,s:"50k",type:"png",d:0.1,view:false},
{name:"游戏中心-底部bar-已选中",w:138,h:138,s:"50k",type:"png",d:0.05,view:false},
{name:"游戏中心-底部bar-背景",w:1080,h:186,s:"100k",type:"png",d:0.1,view:false},
{name:"游戏中心-氛围背景",w:1080,h:1400,s:"500k",type:"jpg",d:0.1,view:false},
{name:"游戏中心-活动大图",w:984,h:1092,s:"500k",type:"jpg",d:0.1,view:false},
{name:"游戏中心-吸顶图",w:1032,h:210,s:"500k",type:"jpg",d:0.07,view:false},
{name:"游戏中心-右置图",w:210,h:210,s:"500k",type:"jpg",d:0.05,view:false},
{name:"游戏中心-Tab氛围-未选中",w:60,h:360,s:"",type:"png",d:0.05,view:false},
{name:"游戏中心-Tab氛围-选中",w:60,h:360,s:"",type:"png",d:0.05,view:false},
{name:"游戏中心-动态icon",w:512,h:512,s:"1024k",type:"gif",d:0.1,view:false},
{name:"游戏中心-每日一荐",w:1080,h:1164,s:"500k",type:"jpg",d:0.1,view:false},
{name:"游戏中心-新游推荐位",w:984,h:750,s:"150k",type:"jpg",d:0.05,view:false},
{name:"游戏中心-新游预约详情页(原画）",w:1080,h:1400,s:"200k",type:"jpg",d:0.05,view:false},
{name:"应用商店-闪屏-全屏",w:1080,h:2160,s:"300k",type:"jpg",d:0.1,view:false},
{name:"应用商店-闪屏-半屏",w:1080,h:1880,s:"300k",type:"jpg",d:0.1,view:false},
{name:"应用商店-闪屏-游戏专用",w:1080,h:1920,s:"300k",type:"jpg",d:0.1,view:false},
{name:"应用商店-应用名称后标签",w:166,h:44,s:"",type:"png",d:0.01,view:false},
{name:"应用商店-按钮",w:162,h:78,s:"",type:"png",d:0.01,view:false},
{name:"应用商店-顶部栏目icon",w:104,h:104,s:"",type:"png",d:0.05,view:false},
{name:"应用商店-新banner1",w:720,h:498,s:"150k",type:"jpg",d:0.05,view:false},
{name:"应用商店-新banner2",w:630,h:336,s:"150k",type:"jpg",d:0.05,view:false},
{name:"应用商店-底部tab配置icon",w:90,h:90,s:"30k",type:"jpg",d:0.05,view:false},
{name:"五图1",w:1080,h:720,s:"500k",type:"jpg",d:0.05,view:false},
{name:"五图2",w:1080,h:720,s:"500k",type:"jpg",d:0.05,view:false},
{name:"五图3",w:1080,h:720,s:"500k",type:"jpg",d:0.05,view:false},
{name:"五图4",w:1080,h:720,s:"500k",type:"jpg",d:0.05,view:false},
{name:"五图5",w:1080,h:720,s:"500k",type:"jpg",d:0.05,view:false},
{name:"宣传卡片",w:1280,h:720,s:"500k",type:"jpg",d:0.07,view:false},
{name:"预约头图",w:1080,h:1400,s:"200k",type:"jpg",d:0.07,view:false},
{name:"弹窗1",w:885,h:930,s:"500k",type:"png",d:0.1,view:false},
{name:"弹窗2",w:1668,h:849,s:"500k",type:"png",d:0.1,view:false},
    ];
    const 华为 = [{name:"测试1"},{name:"测试2"}];
    const 九游 = [{name:"测试1"},{name:"测试2"}];
    const 联想 = [{name:"测试1"},{name:"测试2"}];
    const _233 = [{name:"测试1"},{name:"测试2"}];
    const 荣耀 = [{name:"测试1"},{name:"测试2"}];
    const oppo = [
    {name:"信息流-横版视频",w:1280,h:720,s:"150k",type:"jpg",d:0.01,view:false},
{name:"信息流-竖版视频",w:720,h:1280,s:"150k",type:"jpg",d:0.07,view:false},
{name:"信息流-横版大图",w:1280,h:720,s:"150k",type:"jpg",d:0.07,view:false},
{name:"信息流-竖版大图",w:1080,h:1920,s:"300k",type:"jpg",d:0.07,view:false},
{name:"信息流-横版组图(3张)",w:320,h:210,s:"100k",type:"jpg",d:0.1,view:false},
{name:"信息流-横版小图",w:320,h:210,s:"100k",type:"jpg",d:0.1,view:false},
{name:"锁屏图组",w:1782,h:3168,s:"5120k",type:"jpg",d:0.1,view:false},
{name:"锁屏-详情页底部banner",w:985,h:420,s:"500k",type:"jpg",d:0.05,view:true},
{name:"锁屏-划屏",w:1782,h:3168,s:"5120k",type:"jpg",d:0.07,view:false},
{name:"锁屏-IP图",w:198,h:255,s:"500k",type:"jpg",d:0.01,view:false},
{name:"锁屏-IP图-效果",w:720,h:1280,s:"",type:"jpg",d:0.05,view:false},
{name:"闪屏",w:1080,h:2400,s:"2048k",type:"jpg",d:0.1,view:true},
{name:"游戏中心-节点推广",w:984,h:554,s:"1024k",type:"jpg",d:0.1,view:false},
{name:"游戏中心-站内信",w:984,h:369,s:"500k",type:"jpg",d:0.1,view:false},
{name:"游戏中心-小卡轮播",w:984,h:369,s:"1024k",type:"jpg",d:0.1,view:false},
{name:"游戏中心-首页banner大卡",w:1280,h:720,s:"4096k",type:"jpg",d:0.07,view:false},
{name:"游戏中心-首页大卡",w:1080,h:1080,s:"2048k",type:"jpg",d:0.05,view:false},
{name:"游戏中心-负一屏",w:231,h:174,s:"500k",type:"jpg",d:0.05,view:false},
{name:"浮标",w:240,h:240,s:"200k",type:"png",d:0.05,view:true},
{name:"游戏频道banner",w:984,h:369,s:"1024k",type:"jpg",d:0.1,view:false},
{name:"视频-游戏横划组件",w:984,h:369,s:"500k",type:"jpg",d:0.05,view:false},
{name:"视频-个人中心banner",w:980,h:270,s:"500k",type:"jpg",d:0.05,view:false},
{name:"软件商店-动态icon",w:180,h:180,s:"500k",type:"gif",d:0.1,view:false},
{name:"软件商店-节点氛围卡",w:1280,h:720,s:"500k",type:"jpg",d:0.1,view:false},
{name:"软件商店-应用落地页",w:1080,h:1920,s:"500k",type:"jpg",d:0.1,view:false},
{name:"软件商店-应用卡片",w:1280,h:720,s:"500k",type:"jpg",d:0.01,view:false},
{name:"软件商店-视频每日一荐",w:1280,h:720,s:"1024k",type:"jpg",d:0.01,view:false},
{name:"软件商店-聚量TAB-点击前",w:120,h:120,s:"200k",type:"png",d:0.05,view:false},
{name:"软件商店-聚量TAB-点击后",w:180,h:180,s:"200k",type:"png",d:0.05,view:false},
{name:"软件商店-搜索栏聚量(2张)",w:204,h:120,s:"200k",type:"png",d:0.05,view:false},
{name:"软件商店-精选页弹幕卡片",w:984,h:738,s:"500k",type:"jpg",d:0.05,view:false},
{name:"软件商店-专区预约大卡",w:1280,h:720,s:"1024k",type:"jpg",d:0.05,view:false},
{name:"软件商店-浮层-普通",w:828,h:1284,s:"500k",type:"png",d:0.05,view:false},
{name:"软件商店-浮层-异形",w:984,h:1440,s:"500k",type:"png",d:0.05,view:false},
{name:"PUSH-大图",w:984,h:369,s:"1024k",type:"jpg",d:0.05,view:false},
{name:"PUSH-小图",w:144,h:144,s:"200k",type:"jpg",d:0.05,view:false},
{name:"软件商店-首页轮播1",w:1280,h:720,s:"1024k",type:"jpg",d:0.07,view:false},
{name:"软件商店-首页轮播2",w:1080,h:594,s:"1024k",type:"jpg",d:0.07,view:false},
{name:"浏览器-游戏专题轮播图",w:1280,h:720,s:"500k",type:"jpg",d:0.1,view:false},
{name:"浏览器-游戏专区大卡",w:1080,h:1080,s:"",type:"jpg",d:0.1,view:false},
{name:"浏览器-信息流大图",w:640,h:360,s:"500k",type:"jpg",d:0.1,view:false},
{name:"浏览器-游戏频道小卡片",w:480,h:270,s:"200k",type:"jpg",d:0.1,view:false},
{name:"浏览器-摇一摇闪屏",w:1080,h:2400,s:"300k",type:"jpg",d:0.1,view:false},
{name:"浏览器-首页皮肤-新版",w:1088,h:602,s:"500k",type:"jpg",d:0.1,view:true},
{name:"浏览器-首页皮肤-旧版",w:1088,h:602,s:"500k",type:"jpg",d:0.1,view:true},
{name:"浏览器-热门活动",w:984,h:270,s:"500k",type:"jpg",d:0.1,view:false},
{name:"浏览器-活动入口",w:800,h:176,s:"200k",type:"jpg",d:0.1,view:false},
{name:"负一屏-游戏预约卡片",w:480,h:480,s:"500k",type:"jpg",d:0.1,view:false},
{name:"负一屏-游戏品专banner",w:1280,h:720,s:"500k",type:"jpg",d:0.1,view:false},
{name:"负一屏-游戏服务卡",w:1280,h:720,s:"500k",type:"jpg",d:0.1,view:false},
{name:"负一屏-信息流大图",w:640,h:320,s:"500k",type:"jpg",d:0.1,view:false},
{name:"负一屏-精选卡片",w:1080,h:608,s:"500k",type:"jpg",d:0.1,view:false},
{name:"桌面推荐大卡",w:1080,h:608,s:"500k",type:"jpg",d:0.1,view:false},
{name:"桌面推荐小卡",w:608,h:608,s:"500k",type:"jpg",d:0.1,view:false},
{name:"opush-精彩推荐",w:984,h:465,s:"150k",type:"jpg",d:0.1,view:false},
{name:"自动化短信图",w:936,h:526,s:"500k",type:"jpg",d:0.1,view:false},
{name:"短信图",w:936,h:526,s:"200k",type:"jpg",d:0.1,view:false},
    ];
    const _4399 = [{name:"测试1"},{name:"测试2"}];
    const 小米 = [{name:"测试1"},{name:"测试2"}];
    const 好游快爆 = [{name:"测试1"},{name:"测试2"}];
    const 手机QQ = [{name:"测试1"},{name:"测试2"}];
    const 应用宝 = [{name:"测试1"},{name:"测试2"}];
    const QQ浏览器 = [{name:"测试1"},{name:"测试2"}];
    const 腾讯游戏 = [{name:"测试1"},{name:"测试2"}];
    const 微信 = [{name:"测试1"},{name:"测试2"}];
    const 手机管家 = [{name:"测试1"},{name:"测试2"}];
    const 大神 = [{name:"测试1"},{name:"测试2"}];
    const CC = [{name:"测试1"},{name:"测试2"}];
    const DD = [{name:"测试1"},{name:"测试2"}];

    const sheet = {
    "vivo":[...vivo],
    "华为":[...华为],
    "九游":[...九游],
    "联想":[...联想],
    "_233":[..._233],
    "荣耀":[...荣耀],
    "oppo":[...oppo],
    "_4399":[..._4399],
    "小米":[...小米],
    "好游快爆":[...好游快爆],
    "手机QQ":[...手机QQ],
    "应用宝":[...应用宝],
    "QQ浏览器":[...QQ浏览器],
    "腾讯游戏":[...腾讯游戏],
    "微信":[...微信],
    "手机管家":[...手机管家],
    "大神":[...大神],
    "CC":[...CC],
    "DD":[...DD],
    }

    const models = [
        {name:"江湖快意",img:"url()"},
        {name:"清新古风",img:"url()"},
        {name:"暗黑神秘",img:"url()"},
        {name:"科技硬核",img:"url()"},
        {name:"搞怪有趣",img:"url()"},
        {name:"唯美梦幻",img:"url()"},
        {name:"雍容华贵",img:"url()"},
        {name:"节日喜庆",img:"url()"},
    ]
    const root = document.documentElement;
    const modelList = document.getElementById('model-list');
    const modelMain = document.getElementById('model-main');
    const ediD = document.getElementById('editor-data');
    const ediF = document.getElementById('editor-flow');
    const ediV = document.getElementById('editor-view');
    var allKey = [];//记录所选择的key，一般就一个，除非是多渠道
    var allImg = [];//记录添加的资源位
    var exportAllInfo = '';//汇总信息
    var lightTheme = {
    "mainColor":"#2b2b2b",
    "mainColor2":"#2bc780",
    "mainColor3":"#000",
    "boxBod":"#aeaeae",
    "boxBak":"#eeeeee",
    "boxGry":"#dddddd",
    "liColor1":"#d03b3b",
    "link":"#4e7075",
    "btn-copy-bg":"#96fcb8",
    "bg-mask":"200,200,200",
    "hl-op":"1"
    }
    var darkTheme = {
    "mainColor":"#acacac",
    "mainColor2":"#378360",
    "mainColor3":"#fff",
    "boxBod":"#5d5d5d",
    "boxBak":"#202020",
    "boxGry":"#393939",
    "liColor1":"#d03b3b",
    "link":"#4e7075",
    "btn-copy-bg":"#ffffff11",
    "bg-mask":"20,20,20",
    "hl-op":"0.4"
    }
    var styleKey = Object.keys(lightTheme);//主题色键值
    var styleValue = Object.values(lightTheme);//主题色色值
    var styleKey2 = Object.keys(darkTheme);//主题色键值
    var styleValue2 = Object.values(darkTheme);//主题色色值
    var AItoKeysArea;
    var modelPick = null;
    

    class btnadd extends HTMLElement {
      constructor() {
        super();
        this.innerHTML = `
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" version="1.1" width="100%" height="100%" viewBox="0 0 17 17">
            <g>
                <g>
                    <rect x="7.5" y="3.5" width="2" height="10" rx="0" fill="var(--mainColor)" fill-opacity="1"/>
                </g>
                <g>
                    <rect x="3.5" y="7.5" width="10" height="2" rx="0" fill="var(--mainColor)" fill-opacity="1"/>
                </g>
                <g>
                    <ellipse cx="8.5" cy="8.5" rx="8" ry="8" fill-opacity="0" stroke-opacity="1" stroke="var(--mainColor)" fill="none" stroke-width="1"/>
                </g>
            </g>
        </svg>
        `;
      }
    }
    customElements.define('btn-add', btnadd);

    class btnclose extends HTMLElement {
      constructor() {
        super();
        this.innerHTML = `
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" version="1.1" width="100%" height="100%" viewBox="0 0 17 17">
            <g>
                <g>
                    <rect x="3.5" y="7.5" width="10" height="2" rx="0" fill="var(--mainColor)" fill-opacity="1"/>
                </g>
                <g>
                    <ellipse cx="8.5" cy="8.5" rx="8" ry="8" fill-opacity="0" stroke-opacity="1" stroke="var(--mainColor)" fill="none" stroke-width="1"/>
                </g>
            </g>
        </svg>
        `;
      }
    }
    customElements.define('btn-close', btnclose);

    class btncopy extends HTMLElement {
        constructor() {
            super();
            this.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" version="1.1" width="100%" height="100%" viewBox="0 0 11 11">
                <g>
                    <g>
                        <path d="M5,2L4,2L4,4L2,4L2,5L4,5L4,7L5,7L5,5L7,5L7,4L5,4L5,2Z" fill-rule="evenodd" fill="var(--mainColor)" fill-opacity="1"/>
                    </g>
                    <g>
                        <path d="M0,2.5L0,6.5Q0,7.53553,0.732233,8.26777Q1.29574,8.83127,2.03888,8.96112Q2.16872,9.70426,2.73223,10.2678Q3.46447,11,4.5,11L8.5,11Q9.53553,11,10.2678,10.2678Q11,9.53553,11,8.5L11,4.5Q11,3.46447,10.2678,2.73223Q9.70426,2.16872,8.96112,2.03888Q8.83127,1.29574,8.26777,0.732233Q7.53553,0,6.5,0L2.5,0Q1.46447,0,0.732233,0.732233Q0,1.46447,0,2.5ZM9,3.08099L9,6.5Q9,7.53553,8.26777,8.26777Q7.53553,9,6.5,9L3.08099,9Q3.18864,9.30996,3.43934,9.56066Q3.87868,10,4.5,10L8.5,10Q9.12132,10,9.56066,9.56066Q10,9.12132,10,8.5L10,4.5Q10,3.87868,9.56066,3.43934Q9.30996,3.18864,9,3.08099ZM1.43934,7.56066Q1,7.12132,1,6.5L1,2.5Q1,1.87868,1.43934,1.43934Q1.87868,1,2.5,1L6.5,1Q7.12132,1,7.56066,1.43934Q8,1.87868,8,2.5L8,6.5Q8,7.12132,7.56066,7.56066Q7.12132,8,6.5,8L2.5,8Q1.87868,8,1.43934,7.56066Z" fill-rule="evenodd" fill="var(--mainColor)" fill-opacity="1"/>
                    </g>
                </g>
            </svg>
            `;
        }
    }
    customElements.define('btn-copy', btncopy);

    class btnre extends HTMLElement {
        constructor() {
            super();
            this.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" version="1.1" width="100%" height="100%" viewBox="0 0 20 20">
                <g>
                    <g>
                        <path d="M12.2855,7.6273202612304685L11.71607,9.752400261230468L6.11928,3.5940002612304687L14.0454,1.0590667722304687L13.5682,2.8400802612304688C16.2837,4.193330261230469,18,6.966240261230468,18,10.000240261230468C18,12.14093026123047,17.142,14.192330261230468,15.618,15.695630261230468C15.8708,14.991330261230468,16,14.248530261230469,16,13.500230261230469C16,10.989500261230468,14.554,8.703270261230468,12.2855,7.6273202612304685ZM6.43178,17.16043026123047L5.95456,18.94143026123047L13.8807,16.40643026123047L8.28393,10.248070261230469L7.71452,12.373130261230468C5.446,11.29723026123047,4,9.010970261230469,4,6.500240261230469C4,5.751890261230469,4.12923,5.009170261230469,4.38199,4.304810261230468C2.857956,5.808120261230469,2,7.859530261230469,2,10.000240261230468C2,13.03423026123047,3.71629,15.80713026123047,6.43178,17.16043026123047Z" fill-rule="evenodd" fill="var(--boxBod)" fill-opacity="1"/>
                    </g>
                </g>
            </svg>
            `;
        }
    }
    customElements.define('btn-re', btnre);

    class btnchange extends HTMLElement {
        constructor() {
            super();
            this.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" version="1.1" width="100%" height="100%" viewBox="0 0 18 12">
                <g>
                    <g>
                        <path d="M7.84606,8.545449999999999L7.84606,10L3.9999561143,8.25454L3.9999561143,7.09091L7.07693,7.09091L7.84606,7.09091L13.99991,7.09091L13.99991,8.545449999999999L7.84606,8.545449999999999ZM10.15385,3.4545500000000002L10.15385,2L13.99996,3.74546L13.99996,4.90909L10.15385,4.90909L4,4.90909L4,3.4545500000000002L10.15385,3.4545500000000002Z" 
                        fill-rule="evenodd" fill="var(--mainColor3)" fill-opacity="1"/>
                    </g>
                </g>
            </svg>
            `;
        }
    }
    customElements.define('btn-change', btnchange);


    window.onload = function(){
        addOption("select-area-",sheet,0);
        addOption("select-area-",sheet,'ai');
        addOption("select-img-",[],0);
        allKey.push('');//默认值
        allImg[0] = '';//默认值
        viewPage(2);
        addModelList(models)
    }

    
    var btnAdd = '<btn-add></btn-add>';
    var btnClose = '<btn-close></btn-close>';
    var btnCopy = '<btn-copy></btn-copy>';
      
    function addList(e){

        var select = '<option value="选择渠道" disabled selected>选择渠道</option>'; 
        Object.keys(sheet).forEach(item => {
            if ( item == '大神' || item == 'CC' || item == 'DD'){
                select += '<option style="color:var(--keysLiColor)" value="' + item + '">' + item + '</option>'
            } else {
                if( item.split("_").length > 1){
                    select += '<option value="' + item.replace("_","") + '">' + item.replace("_","") + '</option>'
                } else {
                    select += '<option value="' + item + '">' + item + '</option>'
                }
            }
            
        })

        var selectImg = '<option value="选择资源位" disabled selected>选择资源位</option>'; 

        allKey[e] = '';
        allImg[e] = '';
        
        var node = document.createElement('div');
        node.id = "exports-" + e;
        node.className = "tags-exports";
        node.innerHTML = `
            <div class="list">
                <div class="set" style="width: 60ch;">
                    <div style="display: flex; gap:4px">
                        <div id="add-`+ e +`" class="btn-text" style="width: 17px; height: 17px;" onclick="addList(`+ (e + 1) +`);this.parentNode.style.opacity = 0.222; this.parentNode.style.pointerEvents = 'none';"><btn-add></btn-add></div>
                        <div id="close-`+ e +`" class="btn-text" style="width: 17px; height: 17px;" onclick="closeList(`+ e +`);reImgInfo(`+ e +`,0,null);reClick('key',`+ (e - 1) +`);"><btn-close></btn-close></div>
                    </div>
                    <select id="select-area-`+ e +`" class="input-btn-skill" name="渠道" style=" width: 26ch; min-width: 20ch; color: var(--mainColor); font-size: 12px;" 
                    onchange="reSelectImg(`+ e +`,this.value);reImgInfo(`+ e +`,0,null);reKeysInfo(`+ e +`,this.value);document.getElementById('imgs-`+ e +`').style.display = 'flex'">
                    ` + select +`
                    </select>
                </div>
                <div class="group" id="imgs-`+ e +`" style="display:none; max-width: 500px;">
                    <div class="set" id="img-`+ e +`-0" >
                        <div style="display: flex; gap:4px">
                            <div id="add-`+ e +`-0" class="btn-text" style="width: 17px; height: 17px;" onclick="addImg(`+ e +`,1,allKey[`+ e +`]);this.parentNode.style.opacity = 0.222; this.parentNode.style.pointerEvents = 'none'; reImgInfo(`+ e +`,1,document.getElementById('select-img-`+ e +`-1').value)"><btn-add></btn-add></div>
                            <div id="close-`+ e +`-0" class="btn-text" style="width: 17px; height: 17px; opacity:0.222; pointer-events: none;"><btn-close></btn-close></div>
                        </div>
                        <select id="select-img-`+ e +`-0" class="input-btn-skill" name="资源位" style=" width: calc(100% - 8ch); color: var(--mainColor); font-size: 12px;" 
                        onchange="reImgInfo(`+ e +`,0,this.value)">
                        ` + selectImg +`
                        </select>
                    </div>
                </div>
            </div>
            </div>
        `

        document.getElementById("page-main-1").appendChild(node);
        toView("exports-" + e)
    }

    function toView(id){
        document.getElementById(id).scrollIntoView({
            behavior:'smooth'
        })
    }


    function closeList(e){
        document.getElementById("exports-" + e).remove()
    }

    function addOption(type,list,e){
        if (!Array.isArray(list)){
            var option = document.createElement('option');
            option.disabled = true;
            option.selected = true;
            option.value = '选择渠道';
            option.innerHTML = '选择渠道';
            document.getElementById(type + e).appendChild(option)
            Object.keys(list).forEach(item => {
                var option = document.createElement('option');
                if ( item == '大神' || item == 'CC' || item == 'DD'){
                    option.value = item;
                    option.innerHTML = item;
                    option.style.color = "#ffffff88";
                    option.style.backgroundColor = "var(--keysLiColor)";
                } else {
                    if( item.split("_").length > 1){
                        option.value = item.replace("_","");
                        option.innerHTML = item.replace("_","");
                    } else {
                        option.value = item;
                        option.innerHTML = item;
                    }
                }
                document.getElementById(type + e).appendChild(option)
            })
        } else {
            var option = document.createElement('option');
            option.disabled = true;
            option.selected = true;
            option.value = '选择资源位';
            option.innerHTML = '选择资源位';
            document.getElementById(type + e).appendChild(option);
            list.forEach(item => {
                var option = document.createElement('option');
                option.value = item.name;
                option.innerHTML = item.name;
                document.getElementById(type + e).appendChild(option)
            })
        
        }
        
    }

    function reSelectImg(e,key){
        document.getElementById("imgs-" + e).innerHTML = ''
        addImg(e,0,key)
    }

    function addImg(e,ee,key){
        console.log("addimg",e,ee)
        var selectImg = '<option value="选择资源位" disabled selected>选择资源位</option>'; 

        if ( isNaN(key*1) ){
            var keys = key
        } else {
            var keys = '_' + key;
        }
        var names = sheet[keys].map(item => item.name);
        var garoups = [];
        names.forEach(item => {
            var optionKey = '<optgroup label="' + item.split('-')[0] + '">';
            var optionNor = '<optgroup label="通用">'
            if(item.split('-').length > 1){
                if( !garoups.includes(optionKey)){
                    garoups.push(optionKey)
                }
            }else{
                if(!garoups.includes(optionNor)){
                    garoups = [optionNor,...garoups]
                }
            }
        })

        //console.log('分组：',garoups)
        garoups.forEach(optG => {
            sheet[keys].forEach(item => {
                if(item.name.split('-').length > 1){
                    if(optG.split('"')[1] == item.name.split('-')[0]){
                        optG += '<option value="' + item.name + '">' + item.name + '</option>'
                    } 
                } else {
                    if (optG.split('"')[1] == '通用') {
                        optG += '<option value="' + item.name + '">' + item.name + '</option>'
                    }
                }
            }) 
            optG += '</optgroup>' ;
            selectImg += optG
            //console.log(optG)
        })

        /*
        sheet[keys].forEach(item => {
            selectImg += '<option value="' + item.name + '">' + item.name + '</option>'
        })
        */

        allImg[e][ee] = ''

        var node = document.createElement('div');
        node.id = "img-" + e + "-" + ee;
        node.className = "set";
        if (ee == 0){
            node.innerHTML = `
            <div style="display: flex; gap:4px">
                <div id="add-`+ e +`-`+ ee +`" class="btn-text" style="width: 17px; height: 17px;" onclick="addImg(`+ e +`,`+ (ee + 1) +`,allKey[`+ e +`]);this.parentNode.style.opacity = 0.222; this.parentNode.style.pointerEvents = 'none';reImgInfo(`+ e +`,`+ ee +`,document.getElementById('select-img-`+ e +`-`+ (ee + 1) +`').value)"><btn-add></btn-add></div>
                <div id="close-`+ e +`-`+ ee +`" class="btn-text" style="width: 17px; height: 17px; opacity:0.222; pointer-events: none; "><btn-close></btn-close></div>
            </div>
            <select id="select-img-`+ e +`-`+ ee +`" class="input-btn-skill" name="资源位" style=" width: calc(100% - 8ch); color: var(--mainColor); font-size: 12px; text-align: left;" 
            onchange="reImgInfo(`+ e +`,`+ ee +`,this.value)">
            ` + selectImg +`
            </select>
        `
        } else {
            node.innerHTML = `
            <div style="display: flex; gap:4px">
                <div id="add-`+ e +`-`+ ee +`" class="btn-text" style="width: 17px; height: 17px;" onclick="addImg(`+ e +`,`+ (ee + 1) +`,allKey[`+ e +`]);this.parentNode.style.opacity = 0.222; this.parentNode.style.pointerEvents = 'none';reImgInfo(`+ e +`,`+ ee +`,document.getElementById('select-img-`+ e +`-`+ (ee + 1) +`').value)"><btn-add></btn-add></div>
                <div id="close-`+ e +`-`+ ee +`" class="btn-text" style="width: 17px; height: 17px;" onclick=" if((this.id.split('-')[2]) !== '0'){closeImg(`+ e +`,`+ ee +`)};reImgInfo(`+ e +`,`+ ee +`,null);reClick('img',`+ e +`,`+ (ee - 1) +`);"><btn-close></btn-close></div>
            </div>
            <select id="select-img-`+ e +`-`+ ee +`" class="input-btn-skill" name="资源位" style=" width: calc(100% - 8ch); color: var(--mainColor); font-size: 12px; text-align: left;" 
            onchange="reImgInfo(`+ e +`,`+ ee +`,this.value)">
            ` + selectImg +`
            </select>
        `
        }
        

        document.getElementById("imgs-" + e).appendChild(node);
        toView("img-" + e + "-" + ee)
    }

    function closeImg(e,ee){
        document.getElementById("img-" + e + "-" + ee).remove()
    }

    
    function reImgInfo(e,ee,name){
        console.log('reImgInfo',name);
        //console.log(e,ee,name);
        if (name !== '选择资源位'){
            if (name){
                allImg[e][ee] = name
                ///console.log(666,name);
                reExportInfo()
            } else {
                console.log('reImgInfo','删除');
                allImg[e][ee] = ''
                //console.log(777);
                reExportInfo()
            }
        }   
    }

    function reKeysInfo(e,key){
        console.log('reKeysInfo');
        if ( key !== '选择渠道'){
            allKey[e] = key;
            allImg[e] = [];
            if ( isNaN(key*1) ){
                var keys = key
            } else {
                var keys = '_' + key;
            }
            //console.log(keys)
            allImg[e][0] = '';
            //console.log(allKey,allImg);
            reExportInfo()
        }
        

    }

    function reExportInfo(){
        console.log('reExportInfo')
        var start = "name\tw\th\ts\ttype\n";
        var exports = '';
        var numD = 0,numImg = 0,numView = 0;
        for(var i = 0; i < allKey.length; i ++){
            for(var ii = 0; ii < allImg[i].length; ii++){
                if(allImg[i][ii] && allImg[i][ii].length > 0){
                    var img = sheet[allKey[i]].find(item => item.name == allImg[i][ii])
                    exports += allKey[i] + "/" + img.name + '\t' + img.w + '\t' + img.h + '\t' + img.s + '\t' + img.type + '\n';  
                    numD += img.d * 100;
                    numImg++;
                    if(img.view){
                        numView++
                    } 
                }
                
                 
            }
        }
        document.getElementById("export-info").value = start + exports;
        if (exports){
            document.getElementById('btn-copy').style.display = 'flex';
            document.getElementById('btn-copy-info').style.display = 'flex';
        }
        document.getElementById("num-img").innerHTML = numImg;
        document.getElementById("num-view").innerHTML = numView;
        document.getElementById("num-all").innerHTML = (numView*1 + numImg*1);
        document.getElementById("num-d").innerHTML = numD/100 + "d";
        exportAllInfo = '渠道：' + [...allKey] + '\n' + "切图:" +  numImg + "; 效果图：" + numView +  "; 合计：" + (numView*1 + numImg*1) + ';\n' +  "预估人天：" + numD/100 + "d";
    }

    function reClick(type,e,ee){
        if (type == 'img'){
            document.getElementById("add-" + e + "-" + ee).parentNode.style.opacity = 1;
            document.getElementById("add-" + e + "-" + ee).parentNode.style.pointerEvents = 'auto'
        }
        if (type == 'key'){
            document.getElementById("add-" + e).parentNode.style.opacity = 1;
            document.getElementById("add-" + e).parentNode.style.pointerEvents = 'auto'
        }
    }


    function AItoKeys(input){
        //console.log(input)
        var keywords = []
        Object.keys(sheet).forEach(item => {
            keywords.push(...sheet[item].map(imgs => imgs.name))
        })
        //console.log(keywords)
        if(input){
            var sentences = input.replace(/\s+/g,'-').split(/\/[\t\r\n\.\?\!]+/).map(s => s.trim());
            var options = {
                includeScore:true,
                threshold:0.7,
                keys:['sentence']
            };
            var fuse = new Fuse(sentences.map(sentence => ({sentence})),options);
            console.log(fuse)
            var toTags = [];
            keywords.forEach(item => {
                sentences.forEach(sentence => {
                    var result = fuse.search(item);
                    if ( result.length > 0){
                        toTags.push(...Array(result.length).fill(item))
                    }
                })

            })

            console.log(toTags)
        }
        if(input == ''){
            setTimeout(()=>{
                document.getElementById('btn-ai').style.animation = 'none'
            },2000)
            tipsAll('未检测到数据','2000')
            
        } 
    }

    function tipsAll(string,time){
        var tips = document.getElementById('tips-all');
        var text = document.getElementById('tips-box');
        tips.style.display = "flex";
        text.innerHTML = string;
        setTimeout(()=>{
            tips.style.display = "none";
            text.innerHTML = '';
        },time)
    }

    function addModelList(list){
        list.forEach((value,index)=> {
            var node = document.createElement('div')
            node.className = "model-info"
            node.innerHTML = `
            <input type="checkbox" id="model-pick-` + index + `" style="display: none;" 
            onchange="if(this.checked){
            modelPick.push( ` + index + ` );
            }else{
            }"/>
            <label class="model-pick"  for="model-pick-` + index + `" style="position: relative;">
                <div style="position: absolute; bottom:-1px; background:rgba(0,0,0,0.2); width:100%; height:30px; display:flex; justify-content: center;align-items: center; border-radius:0 0 8px 8px; opacity:var(--model-info) ; ">`+ value.name +`</div>
                <div style="width:100%; height:100%; box-sizing: border-box; background:var(--model-img); border-radius: 8px; border:var(--model-b); padding:4px " >` + (index + 1) + `</div>
            </label>`;
            modelList.appendChild(node);
        })
        var node = document.createElement('div');
        node.style.width = "200px";
        node.style.textAlign = "center";
        node.style.opacity = 0.5;
        node.innerHTML = "更多需要请联系定制~";
        modelList.appendChild(node);
        
    }

    const pages = document.querySelectorAll('.page')
    const toolN = document.getElementById('tool-name')
    function viewPage(e){
        console.log('页面-' + e)
        pages.forEach((item,index) => {
            if(index > 0){
                if(item.id.split('-')[1] == e){
                item.style.display = 'flex'
                toolN.innerHTML = document.getElementById('tool-list-' + item.id.split('-')[1]).innerHTML
                document.getElementById('tool-list-' + item.id.split('-')[1]).className = 'tool-option-pick'
                } else {
                    item.style.display = 'none'
                    document.getElementById('tool-list-' + item.id.split('-')[1]).className = 'tool-option'
                }
            } else {
                item.style.display = 'none'
            }
            
        })
    }

    // 监听整个文档的点击事件
    document.addEventListener('mousedown', function (event) {
        var list = document.querySelectorAll('.tool-list')
        var btn = document.getElementById('tool-change')
        list.forEach(item => {
            if(!item.contains(event.target) && !btn.contains(event.target) && document.activeElement){
                item.style.display = 'none';
            }
        })
    })

    //添加噪点
    //noise()
    //https://raw.githubusercontent.com/YNYU01/listEase/refs/heads/main/img/noise.png
    function noise(){
      var noiseV = 4;
      var dom = document.createElement('canvas');
      dom.width = 128;
      dom.height = 128;
      var ctx = dom.getContext('2d');
      for (var i = 0; i < noiseV * dom.width * dom.height; i++) {
        var x = Math.random() * dom.width;
        var y = Math.random() * dom.height;
        var color = Math.floor(Math.random() * 6 + (255 - 16)).toString(16);
        //ctx.fillStyle = `#${color}${color}${color}`;
        ctx.fillStyle = 'rgba(' + Math.random() * 255 + ',' + Math.random() * 255 + ',' + Math.random() * 255+ ',' + (Math.random() * 0.5 + 0.5) + ')';
        ctx.beginPath();
        ctx.arc(x, y, Math.random() * 0.1, 0, 4);
        ctx.fill();
    }
      var url = dom.toDataURL(`image/png`, 1);
      document.getElementById("noise").style.background = 'url("'+ url +'") 0 0/20px 20px,url("'+ url +'") 0 0/50px 50px'
      
    }
</script>

</body>
</head>
</html>
